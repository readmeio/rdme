#! /usr/bin/env node
const chalk = require('chalk');

const updateNotifier = require('update-notifier');
const pkg = require('../package.json');

const { error } = require('../src/lib/logger');
const log = require('../src/lib/logger');

updateNotifier({ pkg }).notify();

require('../src')(process.argv.slice(2))
  .then(msg => {
    if (msg) log(msg);
    return process.exit(0);
  })
  .catch(err => {
    let message = `Yikes, something went wrong! Please try again and if the problem persists, get in touch with our support team at ${chalk.underline(
      'support@readme.io'
    )}.`;

    if (err && 'message' in err) {
      message = err.message;
    }

    error(message);
    return process.exit(1);
  });
